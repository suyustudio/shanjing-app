# V2 GPS 后台保活技术调研

## 调研日期
2026-02-28

## 调研范围
Flutter 后台定位插件

---

## 1. background_locator

### 简介
专为后台定位设计的 Flutter 插件，支持应用被杀死后仍接收位置更新。

### 优点
- ✅ 应用被杀死后仍可获取位置更新
- ✅ 支持 Android 设备重启后自动恢复服务
- ✅ 可在回调中使用其他 Flutter 插件
- ✅ 支持自定义定位间隔和精度

### 缺点
- ❌ 维护状态一般，GitHub 上存在未修复的 Issue
- ❌ Android SDK 34+ 存在兼容性问题
- ❌ Isolate 管理复杂，停止服务时可能残留
- ❌ iOS 后台限制严格，需额外配置

### 适用场景
- 需要持续追踪的物流/配送应用
- 运动轨迹记录（跑步、骑行）
- 需跨进程保活的场景

---

## 2. geolocator

### 简介
Flutter 官方推荐的位置服务插件，功能全面，支持前台和后台定位。

### 优点
- ✅ 维护活跃，社区支持好
- ✅ API 简洁易用，文档完善
- ✅ 支持多平台（Android/iOS/macOS/Web/Windows）
- ✅ 支持临时精确定位权限（iOS）
- ✅ 支持距离计算、方位角计算

### 缺点
- ❌ 后台定位需配合前台服务（flutter_foreground_task）
- ❌ 应用被杀死后无法继续定位
- ❌ 后台定位存在更新间隔（非实时）
- ❌ iOS 后台模式需向 Apple 解释用途

### 适用场景
- 前台导航应用
- 需要精确定位的场景
- 不需要应用被杀死后继续追踪的场景
- 跨平台应用

---

## 对比总结

| 特性 | background_locator | geolocator |
|------|-------------------|------------|
| 应用杀死后定位 | ✅ 支持 | ❌ 不支持 |
| 维护状态 | ⚠️ 一般 | ✅ 活跃 |
| 配置复杂度 | 高 | 中 |
| iOS 兼容性 | ⚠️ 需额外配置 | ✅ 较好 |
| 多平台支持 | Android/iOS | 全平台 |
| 适用场景 | 持续追踪 | 前台/短时后台 |

---

## 建议

1. **若需应用杀死后仍追踪位置** → 使用 `background_locator` 或考虑付费方案 `flutter_background_geolocation`
2. **若仅需前台/短时后台定位** → 使用 `geolocator` + `flutter_foreground_task`
3. **生产环境建议** → 评估 `flutter_background_geolocation`（付费但稳定）
